<template>
    <require from="./graph/workflow-graph-display"></require>
    <require from="./graph/workflow-graph-editor"></require>
    <require from="./excel/excel"></require>
    <require from="common/components/fab/fab-edit"></require>

    <loading-bar if.bind="!workflow"></loading-bar>

    <div if.bind="workflow"
        class="au-animate fade-inup-outup">

        <div class="pull-right">
            <pending-throbber entity.bind="workflow"></pending-throbber>
            <button class="btn btn-fab btn-fab-mini btn-raised btn-danger"
                type="button"
                click.trigger="deleteWorkflow()"
                if.bind="!editing"
                disabled.bind="workflow.pendingRequest">
                <fa name="trash"></fa>
            </button>
            <fab-edit editing.bind="editing"
                disabled.bind="workflow.pendingRequest"
                click.trigger="toggleEditForm()"></fab-edit>
        </div>

        <form submit.delegate="update()">
            <h1>${workflow.name | inCurrentLanguage & signal:UPDATE_SIGNAL}</h1>

            <workflow-graph-display if.bind="!editing"
                workflow.bind="workflow"></workflow-graph-display>

            <div if.bind="editing">
                <multilingual-editor value.bind="workflow.name"
                    disabled.bind="workflow.pendingRequest"></multilingual-editor>
                <workflow-graph-editor workflow.bind="workflow"></workflow-graph-editor>
            </div>

            <excel workflow.bind="workflow"
                editable.bind="editing && !workflow.pendingRequest"></excel>

            <div class="pull-right">
                <pending-throbber entity.bind="workflow"></pending-throbber>
                <button if.bind="editing"
                    class="btn btn-primary btn-raised"
                    disabled.bind="workflow.pendingRequest">
                    <fa name="check"></fa>
                    ${'Save' | t}
                </button>
            </div>
        </form>
    </div>
</template>
