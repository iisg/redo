<template>
    <require from="../add/resource-form"></require>
    <require from="../workflow/resource-workflow"></require>
    <require from="../workflow/resource-place-display.html"></require>
    <require from="./apply-transition-button/apply-transition-button"></require>
    <require from="./resource-metadata-table/resource-metadata-table"></require>
    <require from="../resources-list"></require>
    <require from="common/components/fab/fab-edit"></require>

    <loading-bar if.bind="!resource"></loading-bar>

    <div class="au-animate fade-inup-outup"
        if.bind="resource">

        <div class="pull-right">
            <pending-throbber entity.bind="resource"></pending-throbber>
            <button class="btn btn-danger"
                click.trigger="remove()"
                if.bind="!editing"
                disabled.bind="resource.pendingRequest">
                <fa name="trash"></fa>
            </button>
            <fab-edit editing.bind="editing"
                shift-down
                click.trigger="toggleEditForm()"
                disabled.bind="resource.pendingRequest"></fab-edit>
        </div>

        <h1>
            ${resource | resourceDisplayStrategy:'header'}
        </h1>

        <div class="au-animate anim-height-inout-300"
            if.bind="!editing">
            <resource-metadata-table resource.bind="resource"></resource-metadata-table>

            <dl class="dl-horizontal resource-details">
                <dt>${'Place' | t}</dt>
                <dd>
                    <resource-place-display resource.bind="resource"></resource-place-display>
                </dd>
            </dl>

            <div class="row"
                if.bind="resource.kind.workflow">
                <div class="col-sm-4">
                    <div class="btn-group-vertical au-animate fade-inup-outup btn-block">
                        <apply-transition-button repeat.for="transition of resource.availableTransitions"
                            resource.bind="resource"
                            transition.bind="transition"
                            can-apply-transition.bind="resource.canApplyTransition(transition)"
                            click.trigger="toggleEditForm(transition)"></apply-transition-button>
                    </div>
                </div>
                <div class="col-sm-8">
                    <resource-workflow resource.bind="resource"></resource-workflow>
                </div>
            </div>

            <div if.bind="allowAddChildResource">
                <h3>${'Child resources' | t}</h3>
                <resources-list parent-resource.bind="resource"
                    has-resources.bind="hasChildren"></resources-list>
            </div>
        </div>

        <div class="au-animate anim-height-inout-900 well floating-form-full-width"
            else>
            <resource-form resource-class.bind="resource.resourceClass"
                edit.bind="resource"
                submit.call="saveEditedResource(savedResource, transitionId)"></resource-form>
        </div>
    </div>
</template>
