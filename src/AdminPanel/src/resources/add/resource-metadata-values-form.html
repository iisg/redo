<template>
    <require from="./resource-metadata-value-input"></require>
    <require from="./new-metadata-value-button"></require>

    <table class="table resource-metadata-values-table"
        ref="valueTable">
        <tbody oa-sortable="items.bind: resource.contents[metadata.id]; allow-drag.call: isDragHandle($event);">
        <tr repeat.for="item of resource.contents[metadata.id]"
            oa-sortable-item="item.bind: item">
            <td class="index">
                ${$index + 1}.
            </td>
            <td class="content">
                <resource-metadata-value-input metadata.bind="metadata"
                    resource.bind="resource"
                    validation-controller.bind="validationController"
                    value.bind="resource.contents[metadata.id][$index]"
                    disabled.bind="disabled"></resource-metadata-value-input>
            </td>
            <td class="action">
                <a class="btn btn-default btn-narrow drag-handle vertically-sortable ${metadata.hovered ? 'btn-raised' : ''}"
                    bootstrap-tooltip.bind="'Drag to change order' | t"
                    data-placement="left"
                    if.bind="resource.contents[metadata.id].length > 1">
                    <fa name="sort"></fa>
                </a>
                <button type="button"
                    disabled.bind="disabled"
                    class="btn pull-right btn-danger"
                    click.trigger="deleteIndex($index)">
                    <fa name="trash fw"></fa>
                </button>
            </td>
        </tr>
        <tr if.bind="!disabled">
            <td colspan="3">
                <new-metadata-value-button metadata.bind="metadata"
                    resource.bind="resource"
                    add.delegate="addNew()"></new-metadata-value-button>
            </td>
        </tr>
        </tbody>
    </table>
</template>
