<template>
    <require from="./resource-metadata-value-input"></require>
    <require from="./new-metadata-value-button"></require>
    <require from="common/components/buttons/icon-button"></require>

    <table class="transparent"
        ref="valueTable">
        <tbody oa-sortable="items.bind: resource.contents[metadata.id]; allow-drag.call: isDragHandle($event);">
        <tr repeat.for="item of resource.contents[metadata.id]"
            oa-sortable-item="item.bind: item">
            <td>
                <div>
                    <resource-metadata-value-input metadata.bind="metadata"
                        resource.bind="resource"
                        validation-controller.bind="validationController"
                        value.bind="resource.contents[metadata.id][$index]"
                        disabled.bind="disabled"></resource-metadata-value-input>
                    <a if.bind="resource.contents[metadata.id].length > 1"
                        class="drag-handle"
                        bootstrap-tooltip.bind="'Drag to change order' | t"
                        data-placement="left">
                        <icon name="arrows-2"
                            size="1.5"></icon>
                    </a>
                    <div if.bind="!disabled"
                        class="buttons">
                        <icon-button icon-name="remove-2"
                            on-click.call="deleteIndex($index)"
                            tooltip-text-when-enabled.one-time="'Remove value' | t"></icon-button>
                        <new-metadata-value-button if.bind="$first"
                            metadata.bind="metadata"
                            resource.bind="resource"
                            on-click.call="addNew()"></new-metadata-value-button>
                    </div>
                </div>
            </td>
        </tr>
        <tr if.bind="!resource.contents[metadata.id].length">
            <td if.bind="!disabled">
                <div class="new-metadata-value-button-container">
                    <new-metadata-value-button metadata.bind="metadata"
                        resource.bind="resource"
                        on-click.call="addNew()"></new-metadata-value-button>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</template>
