<template>
    <require from="resources/controls/input/resource-picker/resource-picker"></require>
    <require from="common/value-converters/to-array-value-converter"></require>
    <require from="resources/details/resource-link"></require>

    <div if.bind="metadataValue.value">
        <resource-link id.bind="metadataValue.value"></resource-link>
    </div>

    <div else>
        <resource-picker resource-id.bind="metadataValue.value & validate:validationController:validationRules"
            resource-kind-ids.bind="metadata.constraints.resourceKind"
            contents-filter.bind="metadata.constraints.relatedResourceMetadataFilter"
            resource-class.bind="metadata.id == -1 ? resource.resourceClass : undefined"
            disabled.bind="disabled || metadata.constraints.resourceKind.length === 0"></resource-picker>

        <span if.bind="metadata.constraints.resourceKind.length === 0">
            ${'To see dropdown choose allowed resource kinds in metadata settings.' | t}
        </span>
        <span show.bind="relatedResourceMetadataFilterInfo.filters.length > 0"
            ref="relatedResourceMetadataFilterInfo"
            filters.bind="metadata.constraints.relatedResourceMetadataFilter | toArray">
            ${'Additional filter limits results in this dropdown' | t}: <strong>${relatedResourceMetadataFilterInfo.filters[0].value}</strong>
        </span>
    </div>
</template>
