<template>
    <require from="common/components/buttons/add-button"></require>
    <require from="./user-role-form"></require>

    <add-button entity-name="role"
        toggled.two-way="addFormOpened"></add-button>

    <div if.bind="addFormOpened"
        class="well fade-inup-outdown au-animate floating-form">
        <user-role-form submit.call="addNewRole(savedRole)"></user-role-form>
    </div>

    <table>
        <thead>
            <tr>
                <th>${'Name' | t}</th>
                <th></th>
                <th></th>
            </tr>
        </thead>
        <tfoot>
            <tr if.bind="!roles">
                <th colspan="3">
                    <loading-bar></loading-bar>
                </th>
            </tr>
        </tfoot>
        <tbody class="au-stagger table-hover">
            <tr class="au-animate fade-inup-outdown"
                repeat.for="role of roles">
                <td if.bind="!role.editing">${role.name | inCurrentLanguage}</td>
                <td if.bind="!role.editing"
                    class="with-buttons-container">
                    <div>
                        <button type="button"
                            click.trigger="role.editing = true"
                            disabled.bind="role.pendingRequest">
                            <icon name="edit-2"
                                size="1.25"></icon>
                        </button>
                        <button class="remove"
                            type="button"
                            click.trigger="deleteRole(role)"
                            disabled.bind="role.pendingRequest || role.id < 0">
                            <icon name="remove-4"
                                size="1.25"></icon>
                        </button>
                    </div>
                </td>
                <td if.bind="role.editing"
                    colspan="2">
                    <user-role-form edit.bind="role"
                        cancel.call="role.editing = false"
                        submit.call="saveEditedRole(role, savedRole) && (role.editing = false)"></user-role-form>
                </td>
                <td class="with-throbber"><throbber if.bind="role.pendingRequest"></throbber></td>
            </tr>
        </tbody>
    </table>
</template>
