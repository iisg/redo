<template>
    <require from="common/components/buttons/remove-button"></require>
    <require from="common/components/buttons/edit-button"></require>
    <require from="../resource-kind-form"></require>
    <require from="../../../workflows/details/graph/workflow-graph-display"></require>

    <loading-bar if.bind="!resourceKind"></loading-bar>

    <div else
        class="resource-kind-details">
        <div class="name-with-buttons-and-tabs">
            <span class="page-title">
                ${ resourceKind.label | inCurrentLanguage }
            </span>
            <remove-button if.bind="!editing"
                disabled.bind="resource.pendingRequest"
                on-click.call="deleteResourceKind()"></remove-button>
            <pending-throbber entity.bind="resourceKind"></pending-throbber>
            <aup-tabs tabs.bind="resourceKindDetailsTabs"></aup-tabs>
        </div>
        <aup-tab-content>
            <aup-tab-pane tab="metadata-tab">
                <div if.bind="currentTabId === 'metadata-tab'">
                    <div if.bind="!editing">
                        <div class="pull-right">
                            <edit-button toggled.bind="editing"
                                disabled.bind="resourceKind.pendingRequest"
                                on-click.call="toggleEditForm(false)"></edit-button>
                        </div>
                        <dl class="dl-horizontal resource-kind-metadata-table">
                            <template repeat.for="metadata of resourceKind.metadataList">
                                <div if.bind="metadata.id > 0">
                                    <dt>${metadata.name}</dt>
                                    <dd>
                                        <span>${metadata.label | inCurrentLanguage}</span>
                                        <icon name="show"
                                            if.bind="metadata.shownInBrief"></icon>
                                        <icon name="edit"
                                            if.bind="metadata.copyToChildResource"></icon>
                                    </dd>
                                </div>
                            </template>
                        </dl>
                    </div>
                    <resource-kind-form else
                        resource-class.bind="resourceKind.resourceClass"
                        edit.bind="resourceKind"
                        submit.call="saveEditedResourceKind(resourceKind, savedResourceKind) && toggleEditForm(false)"
                        cancel.call="toggleEditForm(false)"></resource-kind-form>
                </div>
            </aup-tab-pane>
            <aup-tab-pane tab="workflow-tab">
                <div if.bind="currentTabId === 'workflow-tab'">
                    <workflow-graph-display workflow.bind="resourceKind.workflow"></workflow-graph-display>
                </div>
            </aup-tab-pane>
        </aup-tab-content>
    </div>
</template>