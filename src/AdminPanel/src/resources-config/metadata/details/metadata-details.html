<template>
    <require from="common/components/buttons/remove-button"></require>
    <require from="common/components/buttons/edit-button"></require>
    <require from="./metadata-constraint"></require>
    <require from="./metadata-details-list.html"></require>
    <require from="../metadata-list"></require>
    <require from="../metadata-form"></require>
    <require from="../../resource-kind/resource-kinds-list"></require>

    <loading-bar if.bind="!metadata"></loading-bar>

    <div else
        class="metadata-details au-animate fade-inup-outup">

        <div class="name-with-buttons-and-tabs">
            <h1>${'Metadata' | t} #${ metadata.id }</h1>
            <remove-button if.bind="!editing || metadata.id > 0"
                disabled.bind="metadata.pendingRequest"
                on-click.call="deleteMetadata()"></remove-button>
            <pending-throbber entity.bind="metadata"></pending-throbber>
            <aup-tabs tabs.bind="metadataDetailsTabs"></aup-tabs>
        </div>
        <aup-tab-content>
            <aup-tab-pane tab="child-metadata-tab">
                <div if.bind="currentTabId === 'child-metadata-tab'">
                    <metadata-list parent-metadata.bind="metadata"
                        resource-class.bind="metadata.resourceClass"></metadata-list>
                </div>
            </aup-tab-pane>
            <aup-tab-pane tab="details-tab">
                <div if.bind="currentTabId === 'details-tab'">
                    <template if.bind="!editing">
                        <metadata-details-list metadata.bind="metadata"></metadata-details-list>
                        <edit-button toggled.bind="editing"
                            disabled.bind="metadata.pendingRequest"
                            on-click.call="toggleEditForm()"></edit-button>
                    </template>
                    <metadata-form else
                        edit.bind="true"
                        resource-class.bind="resourceClass"
                        template.bind="metadata"
                        submit.call="saveEditedMetadata(metadata, editedMetadata)"
                        cancel.call="toggleEditForm()"></metadata-form>
                </div>
            </aup-tab-pane>
            <aup-tab-pane tab="constraints-tab">
                <div if.bind="currentTabId === 'constraints-tab'">
                    <dl class="constraints-list dl-horizontal">
                        <template repeat.for="constraintName of constraintNames">
                            <dt class="constraints-term-name"> ${'metadata_constraints::labels//' + constraintName | t}</dt>
                            <dd class="constraints-name">
                                <metadata-constraint name.bind="constraintName"
                                    metadata.bind="metadata"></metadata-constraint>
                            </dd>
                        </template>
                    </dl>
                </div>
            </aup-tab-pane>
            <aup-tab-pane tab="resource-kinds-tab">
                <div if.bind="currentTabId === 'resource-kinds-tab'">
                    <div class="resource-kinds">
                        <resource-kinds-list resource-kinds.bind="resourceKindList"
                            hide-add-button></resource-kinds-list>
                    </div>
                </div>
            </aup-tab-pane>
        </aup-tab-content>
    </div>
</template>
